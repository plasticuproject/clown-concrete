"""decode.py"""

import re
from binascii import unhexlify
import requests

requests.packages.urllib3.disable_warnings()

URL = "https://127.0.0.1:42424/"
sess = requests.Session()
csrf = sess.get(URL, verify=False)
data = {"_csrf_token": csrf.cookies["_csrf_token"], "length": 1, "width": 1, "depth": 1, "units": "ft"}
res = sess.post(f"{URL}calculate/square_slab",
                    data=data, headers=dict(Referer=URL),
                    timeout=60, verify=False)
START = "Requires "
END = " cubic"
TEXT = res.text
flag_int = re.findall(fr'(?:{START})([\r\s\S]*?)(?:{END})', TEXT)[0]


def decode_flag(string: str) -> str:
    """Decode flag integer."""
    flag_hex_bytes = hex(int(string)).encode()
    return unhexlify(flag_hex_bytes[2:]).decode()


if __name__ == "__main__":
    print("\n" + decode_flag(flag_int))
